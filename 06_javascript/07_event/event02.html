<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>브라우저 공통 이벤트 예시</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            font-family: sans-serif;
            height: 200vh;
            /* 스크롤 확인 위해 높게 설정 */
            margin: 0;
            padding: 20px;
        }

        #log {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            height: calc(100vh - 20px);
            padding: 10px;
            border: 1px solid #333;
            background: #f9f9f9;
            font-size: 14px;
            white-space: pre-line;
            overflow-y: auto;
            /* 줄바꿈 표시 */
        }

        img {
            width: 300px;
            margin-top: 50px;
        }
    </style>
</head>

<body>
    <h1>브라우저 공통 이벤트 실습</h1>
    <div id="log">이벤트 로그</div>
    <!-- 테스트 이미지 -->
    <img src="https://img1.daumcdn.net/thumb/R1280x0.fjpg/?fname=http://t1.daumcdn.net/brunch/service/user/2fbJ/image/NnLD-6PZ47hikCkXuNfbs88gDtM.jpg"
        alt="테스트이미지" class="testImg">

    <!-- 테스트 버튼 -->
    <div>
        <button id="abortBtn" type="button">이미지 로딩 중단</button>
        <button id="reBtn" type="button">이미지 로딩 다시 시작</button>
        <a href="http://naver.com">네이버</a>
    </div>

    <script>
        const logBox = document.getElementById('log');
        function log(msg) {
            console.log(msg);
            logBox.innerHTML += msg + '\n' //누적 로그
        }

        const testImg = document.querySelector('.testImg')
        const abortBtn = document.querySelector('#abortBtn')
        const reBtn = document.querySelector('#reBtn')
        const imgSrc = testImg.src;
        let order = 1; //실행 순서 카운터

        //1.DOMContentLoaded (DOM만 준비됨)
        document.addEventListener('DOMContentLoaded', () => {
            log(`${order++}:DOMContentLoaded DOM 준비 완료`);
        })

        //2.window.load(모든 리소스 준비 완료)
        window.addEventListener('load', () => {
            log(`${order++}:window.load(모든 리소스 준비 완료)`);
        });

        testImg.addEventListener('load', () => {
            log(`${order++}:img.load(이미지 로딩 완료)`);
        });

        // abort테스트 버튼 클릭 시 이벤트 로딩 중단
        abortBtn.addEventListener('click', () => {
            testImg.src='';//src제거
            log('abortBtn 클릭 : 이미지 로딩 취소 시도');
        });

        //이미지 추가
        reBtn.addEventListener('click', () => {
            testImg.src=imgSrc;
            log('이미지 다시 추가');
        });

        //4.abort(리소스 로딩 중단)
        testImg.addEventListener('abort', () => {
            log(`abort(리소스 로딩 중단)`);
        });

        //4.error(리소스 로딩 실패)
        testImg.addEventListener('error', () => {
            log(`error(리소스 로딩 실패)`);
        });

        window.addEventListener('resize',()=>{
            log(`resize 창크기 ${window.innerWidth}x${window.innerHeight}`);
        });

        window.addEventListener('scroll',()=>{
            log(`scroll Y= ${window.scroll}`);
        });

        window.addEventListener('beforeunload',(e)=>{
            e.preventDefault();
            e.returnValue= '';
            log('beforeunload : 페이지 떠나기 전');
        })
    </script>

</body>

</html>